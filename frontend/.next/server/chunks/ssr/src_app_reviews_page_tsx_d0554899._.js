module.exports=[41496,a=>{"use strict";a.s(["default",()=>Q],41496);var b=a.i(87924),c=a.i(72131),d=a.i(91119),e=a.i(86304),f=a.i(99570),g=a.i(66718),h=a.i(33217),i=a.i(56143),j=a.i(97580),k=a.i(86456),l=a.i(14574),m=a.i(41921),n=a.i(80701),o=a.i(29246),p=a.i(24569),q=a.i(81560),r=a.i(95245),s=a.i(59501),t=a.i(54714),u=a.i(70025),v=a.i(37927),w=a.i(23292),x=a.i(38602);let y=t.object({review_type:t.nativeEnum(x.ReviewType,{message:"리뷰 타입을 선택해주세요"}),positives:t.string().min(1,"긍정적인 점을 입력해주세요"),negatives:t.string().min(1,"부정적인 점을 입력해주세요"),changes_next:t.string().min(1,"다음에 바꿀 점을 입력해주세요")}),z={[x.ReviewType.PREMORTEM]:{label:"사전 검토 (Premortem)",description:"프로젝트 시작 전 위험 요소와 개선점 분석",positiveLabel:"예상되는 장점",negativeLabel:"예상되는 위험",changesLabel:"사전 준비사항"},[x.ReviewType.MIDMORTEM]:{label:"중간 검토 (Midmortem)",description:"프로젝트 진행 중 현황 점검과 조정",positiveLabel:"잘 되고 있는 점",negativeLabel:"문제점",changesLabel:"조정할 점"},[x.ReviewType.RETRO]:{label:"회고 (Retrospective)",description:"프로젝트 완료 후 결과 분석과 학습",positiveLabel:"잘했던 점",negativeLabel:"아쉬웠던 점",changesLabel:"다음에 바꿀 점"}};function A({review:a,taskId:d,triggerText:e="수정"}){let[g,h]=(0,c.useState)(!1),j=(0,v.useQueryClient)(),k=(0,r.useForm)({resolver:(0,s.zodResolver)(y),defaultValues:{review_type:a.review_type,positives:a.positives,negatives:a.negatives,changes_next:a.changes_next}}),t=k.watch("review_type"),x=t?z[t]:null,A=(0,u.useMutation)({mutationFn:({id:a,data:b})=>(0,i.updateReview)(a,b),onSuccess:()=>{w.toast.success("리뷰가 수정되었습니다!"),j.invalidateQueries({queryKey:["reviews",d]}),j.invalidateQueries({queryKey:["all-reviews"]}),h(!1)},onError:a=>{let b=a?.response?.data?.detail||"리뷰 수정에 실패했습니다.";w.toast.error(b),console.error("Error updating review:",a)}}),B=(0,u.useMutation)({mutationFn:i.deleteReview,onSuccess:()=>{w.toast.success("리뷰가 삭제되었습니다!"),j.invalidateQueries({queryKey:["reviews",d]}),j.invalidateQueries({queryKey:["all-reviews"]}),h(!1)},onError:a=>{let b=a?.response?.data?.detail||"리뷰 삭제에 실패했습니다.";w.toast.error(b),console.error("Error deleting review:",a)}}),C=async b=>{let c={task_id:d,review_type:b.review_type,positives:b.positives,negatives:b.negatives,changes_next:b.changes_next};A.mutate({id:a.id,data:c})};return(0,b.jsxs)(l.Dialog,{open:g,onOpenChange:h,children:[(0,b.jsx)(l.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(p.Edit,{className:"mr-2 h-4 w-4"}),e]})}),(0,b.jsxs)(l.DialogContent,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(l.DialogHeader,{children:[(0,b.jsx)(l.DialogTitle,{children:"리뷰 수정"}),(0,b.jsx)(l.DialogDescription,{children:"리뷰 내용을 수정하거나 삭제할 수 있습니다."})]}),(0,b.jsx)(m.Form,{...k,children:(0,b.jsxs)("form",{onSubmit:k.handleSubmit(C),className:"space-y-4",children:[(0,b.jsx)(m.FormField,{control:k.control,name:"review_type",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"리뷰 타입 *"}),(0,b.jsxs)(n.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.SelectTrigger,{children:(0,b.jsx)(n.SelectValue,{placeholder:"리뷰 타입을 선택해주세요"})})}),(0,b.jsx)(n.SelectContent,{children:Object.entries(z).map(([a,c])=>(0,b.jsx)(n.SelectItem,{value:a,children:c.label},a))})]}),x&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:x.description}),(0,b.jsx)(m.FormMessage,{})]})}),x&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.FormField,{control:k.control,name:"positives",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsxs)(m.FormLabel,{children:[x.positiveLabel," *"]}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(o.Textarea,{className:"min-h-[80px]",...a})}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:k.control,name:"negatives",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsxs)(m.FormLabel,{children:[x.negativeLabel," *"]}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(o.Textarea,{className:"min-h-[80px]",...a})}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:k.control,name:"changes_next",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsxs)(m.FormLabel,{children:[x.changesLabel," *"]}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(o.Textarea,{className:"min-h-[80px]",...a})}),(0,b.jsx)(m.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,b.jsxs)(f.Button,{type:"button",variant:"destructive",onClick:()=>{window.confirm("정말로 이 리뷰를 삭제하시겠습니까?")&&B.mutate(a.id)},disabled:B.isPending,children:[(0,b.jsx)(q.Trash2,{className:"mr-2 h-4 w-4"}),B.isPending?"삭제 중...":"삭제"]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>h(!1),children:"취소"}),(0,b.jsx)(f.Button,{type:"submit",disabled:A.isPending,children:A.isPending?"수정 중...":"수정"})]})]})]})})]})]})}var B=a.i(60246),C=a.i(87532),D=a.i(41675),E=a.i(96101),F=a.i(73570),G=a.i(90669),H=a.i(70106);let I=(0,H.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var J=a.i(24669);let K=(0,H.default)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),L=(0,H.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var M=a.i(56711),N=a.i(60178),O=a.i(38246);let P={[x.ReviewType.PREMORTEM]:{label:"사전 검토",description:"시작 전 위험 분석",icon:F.AlertTriangle,color:"bg-yellow-500",variant:"secondary"},[x.ReviewType.MIDMORTEM]:{label:"중간 검토",description:"진행 중 점검",icon:G.Activity,color:"bg-blue-500",variant:"default"},[x.ReviewType.RETRO]:{label:"회고",description:"완료 후 학습",icon:I,color:"bg-green-500",variant:"outline"}};function Q(){let[a,l]=(0,c.useState)(""),{data:m,isLoading:n}=(0,h.useQuery)({queryKey:["all-reviews"],queryFn:i.getAllReviews,retry:!1}),{data:o,isLoading:p}=(0,j.useTasks)(),{data:q,isLoading:r}=(0,k.useProjects)(),s=o?.reduce((a,b)=>(a[b.id]=b,a),{})||{},t=q?.reduce((a,b)=>(a[b.id]=b,a),{})||{},u=m?.filter(b=>{if(!a)return!0;let c=a.toLowerCase(),d=s[b.task_id],e=d?t[d.project_id]:null;return b.positives.toLowerCase().includes(c)||b.negatives.toLowerCase().includes(c)||b.changes_next.toLowerCase().includes(c)||d?.title.toLowerCase().includes(c)||e?.name.toLowerCase().includes(c)||P[b.review_type].label.toLowerCase().includes(c)})||[],v={total:m?.length||0,premortem:m?.filter(a=>a.review_type===x.ReviewType.PREMORTEM).length||0,midmortem:m?.filter(a=>a.review_type===x.ReviewType.MIDMORTEM).length||0,retro:m?.filter(a=>a.review_type===x.ReviewType.RETRO).length||0};return n||p||r?(0,b.jsx)("div",{className:"container mx-auto p-6",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mx-auto"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"리뷰를 불러오는 중..."})]})})}):(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,b.jsx)(B.Users,{className:"h-8 w-8"}),"리뷰 시스템"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Premortem, Midmortem, Retrospective - 체계적인 리뷰 프로세스"})]}),(0,b.jsxs)("div",{className:"relative max-w-md",children:[(0,b.jsx)(C.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(g.Input,{placeholder:"리뷰 내용, 작업명, 프로젝트명으로 검색...",value:a,onChange:a=>l(a.target.value),className:"pl-10"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsx)(d.CardTitle,{className:"text-lg",children:"전체 리뷰"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-bold",children:v.total})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsx)(d.CardTitle,{className:"text-lg text-yellow-600",children:"사전 검토"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-bold",children:v.premortem})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsx)(d.CardTitle,{className:"text-lg text-blue-600",children:"중간 검토"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-bold",children:v.midmortem})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{className:"pb-3",children:(0,b.jsx)(d.CardTitle,{className:"text-lg text-green-600",children:"회고"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"text-3xl font-bold",children:v.retro})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"리뷰 목록"}),(0,b.jsx)(d.CardDescription,{children:u.length?`${u.length}개의 리뷰`:"검색 조건에 맞는 리뷰가 없습니다"})]}),(0,b.jsx)(d.CardContent,{children:0===u.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(B.Users,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:0===v.total?"작성된 리뷰가 없습니다":"검색 결과가 없습니다"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:0===v.total?"프로젝트 상세 페이지에서 작업별로 리뷰를 작성해보세요":"다른 검색어로 시도해보세요"}),0===v.total&&(0,b.jsx)(f.Button,{asChild:!0,children:(0,b.jsx)(O.default,{href:"/projects",children:"프로젝트 보기"})})]}):(0,b.jsx)("div",{className:"space-y-6",children:u.sort((a,b)=>new Date(b.created_at).getTime()-new Date(a.created_at).getTime()).map(a=>{let c=s[a.task_id],g=c?t[c.project_id]:null,h=P[a.review_type],i=h.icon;return(0,b.jsxs)(d.Card,{className:"border-l-4 border-l-indigo-500",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)(e.Badge,{variant:h.variant,className:"flex items-center gap-1",children:[(0,b.jsx)(i,{className:"h-3 w-3"}),h.label]}),(0,b.jsxs)(e.Badge,{variant:"outline",className:"flex items-center gap-1",children:[(0,b.jsx)(D.Calendar,{className:"h-3 w-3"}),(0,M.format)((0,N.parseISO)(a.created_at),"yyyy-MM-dd")]})]}),c&&(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(E.FolderOpen,{className:"h-4 w-4"}),(0,b.jsx)(O.default,{href:`/projects/${c.project_id}`,className:"hover:underline",children:g?.name||`프로젝트 ${c.project_id}`})]}),(0,b.jsxs)("span",{children:["→ ",c.title]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(A,{review:a,taskId:a.task_id})})]})}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-semibold text-sm text-muted-foreground mb-2 flex items-center gap-1",children:[(0,b.jsx)(J.TrendingUp,{className:"h-3 w-3 text-green-600"}),a.review_type===x.ReviewType.PREMORTEM?"예상되는 장점":a.review_type===x.ReviewType.MIDMORTEM?"잘 되고 있는 점":"잘했던 점"]}),(0,b.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:(0,b.jsx)("p",{className:"text-sm",children:a.positives})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-semibold text-sm text-muted-foreground mb-2 flex items-center gap-1",children:[(0,b.jsx)(K,{className:"h-3 w-3 text-red-600"}),a.review_type===x.ReviewType.PREMORTEM?"예상되는 위험":a.review_type===x.ReviewType.MIDMORTEM?"문제점":"아쉬웠던 점"]}),(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,b.jsx)("p",{className:"text-sm",children:a.negatives})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h4",{className:"font-semibold text-sm text-muted-foreground mb-2 flex items-center gap-1",children:[(0,b.jsx)(L,{className:"h-3 w-3 text-blue-600"}),a.review_type===x.ReviewType.PREMORTEM?"사전 준비사항":a.review_type===x.ReviewType.MIDMORTEM?"조정할 점":"다음에 바꿀 점"]}),(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:(0,b.jsx)("p",{className:"text-sm",children:a.changes_next})})]}),(0,b.jsx)("div",{className:"flex justify-end pt-2",children:(0,b.jsx)(f.Button,{asChild:!0,variant:"outline",size:"sm",children:(0,b.jsx)(O.default,{href:`/projects/${c?.project_id}`,children:"작업 보기"})})})]})]},a.id)})})})]})]})}}];

//# sourceMappingURL=src_app_reviews_page_tsx_d0554899._.js.map